<?xml version='1.0' encoding='UTF-8'?>
<!-- This document was created with Syntext Serna Free. --><!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.4//EN" "http://www.oasis-open.org/docbook/xml/4.4/docbookx.dtd" []>
<chapter>
  <title>Pivot Tables e a ferramenta MyDataMart</title>
  <para>Excel Pivot Table (ver imagem abaixo) é uma ferramenta de análise de dados poderosa e dinâmica que podem ser automaticamente ligada aos dados DHIS 2. Enquanto a maioria das ferramentas de relatórios em DHIS 2 são limitados em quantidade de dados que pode apresentar, ao mesmo tempo, as tabelas dinâmicas são projetados para dar uma visão geral agradáveis ​​com vários elementos de dados ou indicadores, e as unidades de organização e períodos (veja exemplo abaixo). Além disso, as características dinâmicas da dinamização e drill-down são muito diferentes das planilhas estáticas ou muitos relatórios web, e seu o torna uma ferramenta útil para os usuários da informação que pretendem fazer uma análise mais aprofundada e de manipular os pontos de vista sobre os dados mais dinamicamente. Isto combinado com as capacidades de gráficos conhecidos de Excel, a ferramenta de tabela dinâmica tornou uma ferramenta de análise popular entre os usuários mais avançados dhis por um longo tempo. </para>
  <graphic fileref="resources/images/implementation_guide/pivot_table.png" format="PNG" width="100%" align="center"/>
  <para>Com a recente mudança para implementações on-line, as tabelas dinâmicas no Excel off-line também fornecem uma alternativa útil para as ferramentas de relatórios on-line, que permitem a análise de dados local sem conectividade com a Internet, o que pode ser uma vantagem em conexões instáveis ​​ou caros. Internet só é necessário o download de novos dados a partir do servidor on-line, e, logo que os dados existem localmente, trabalhando com as tabelas dinâmicas não necessitam de conectividade. A ferramenta MyDatamart, o que é explicado em detalhes mais abaixo, ajuda os usuários a manter um local de data mart arquivo (pequeno banco de dados), que é atualizado através da Internet contra o servidor on-line, e depois usado como uma fonte de dados off-line que alimenta as tabelas dinâmicas com dados. </para>
  <section>
    <title>Desenho da tabela Pivot</title>
    <para>Normalmente um arquivo de tabela dinâmica do Excel configurados para DHIS 2 irá conter várias planilhas com uma tabela dinâmica em cada folha. Uma tabela pode consistir em valores brutos de dados (por elementos de dados) ou valores do indicador, e geralmente será nomeado com base em qual nível da hierarquia de unidade organizacional a fonte de dados são agregados por, bem como o tipo de período (por exemplo, freqüência mensal, anual ) dos dados. Um arquivo de tabela dinâmica DHIS 2 padrão inclui as seguintes tabelas dinâmicas: Distrito de Indicadores, Distrito de dados mensais, Dados Distrito anuais, Indicadores, o Mecanismo de dados mensais, Data Facility anuais. Além disso, pode haver tabelas mais especializados que se concentram em programas específicos e / ou outros tipos de época.</para>
    <para>Uma característica popular de tabelas dinâmicas é ser capaz de arrastar e soltar os diversos campos entre as três posições de página / filtro, linha e colunas, e, assim, mudar completamente a exibição de dados. Estes campos podem ser vistos como dimensões para os valores de dados e representar as dimensões no modelo de dados DHIS; unidade de organização (um campo por nível), elementos de dados ou indicadores, períodos, e então uma lista estendida de forma dinâmica de dimensões adicionais, representando unidade de organização / agrupar conjuntos elemento indicador / dados e categorias de elementos de dados (ver outros capítulos deste guia para detalhes). Na verdade uma tabela dinâmica dinâmica é uma excelente ferramenta para representar as várias dimensões criadas no DHIS 2, e faz com que seja muito fácil de ampliar ou reduzir em cada dimensão, por exemplo, olhar para valores de dados não processados ​​por grupos etários ou apenas por sua totalidade, ou em combinação com outras dimensões, como género. Todas as dimensões criadas no DHIS 2 será refletida na lista de campos disponíveis de cada tabela dinâmica, e então cabe ao usuário selecionar quais usar.</para>
    <para>É importante entender que os valores nas tabelas dinâmicas não são editáveis ​​e todos os nomes e os números são recuperados diretamente do banco de dados DHIS 2, o que o torna diferente de uma planilha normal. A fim de ser editado, o conteúdo de uma tabela dinâmica devem ser copiados para uma planilha normal, mas isso raramente é necessário, pois todos os nomes podem ser editados no DHIS 2 (e, em seguida, ser refletido nas tabelas dinâmicas na próxima atualização). Os nomes (legendas) em cada campo, porém, são editável, mas não o seu conteúdo (os valores).</para>
  </section>
  <section>
    <title>Conectando-se ao banco de dados DHIS 2</title>
    <para>Cada tabela dinâmica tem uma conexão com o banco de dados DHIS 2 e faz uso de uma exibição da fonte de pivô (consulta SQL) no banco de dados para buscar os dados. Essas consultas puxar todos os seus dados a partir das tabelas de data mart, por isso é importante manter a data mart atualizados em todos os momentos, a fim de obter os dados mais recentes sobre as tabelas dinâmicas. A tabela dinâmica pode se conectar a um banco de dados no computador local ou em um servidor remoto. Isto faz com que seja bem apropriado para uso em uma rede local onde não é só uma base de dados comum e vários computadores de clientes, através de tabelas de pivô. Excel também pode se conectar a bancos de dados rodando em Linux. A conexão de banco de dados usado nas tabelas dinâmicas é especificado em uma fonte de dados ODBC em computadores Windows que executam tabelas dinâmicas.</para>
    <para>Para implantações on-line a maneira recomendada para se conectar aos dados DHIS 2 é fazer uso da ferramenta MyDatamart, que cria e atualiza um local, data mart arquivo (banco de dados) que o Excel pode se conectar. A ferramenta MyDatamart será descrito em detalhe mais abaixo.</para>
  </section>
  <section>
    <title>Lidando com grandes quantidades de dados</title>
    <para>The amount of data in a DHIS 2 database can easily go beyond the capabilities of Excel. A table with around 1 million values (rows of data) tend to become less responsive to updates (refresh) and pivoting operations, and on some computers Excel will give out of memory errors when dealing with tables of this size. Typically, the more powerful the computer, the more data can be handled, but the top limit seems to be around 1 million rows even on the high-end computers.</para>
    <para>To deal with this problem the standard DHIS pivot table setup is to split the data over several pivot tables. There are different ways of splitting the data; by organisation unit aggregation level (how deep), by organisation unit coverage/boundary area (how wide), by period (e.g. one year of data at a time), or by data element or indicator groups (e.g. by health programs or themes). Aggregating away the lowest level in the organisation unit hierarchy is the most effective approach as it reduces the amount of data by a factor of the number of health facilities in a country. Typically there is no need to look at all the health facilities in a country at the same time, but instead only for a limited area (e.g. district or province). And when there is a need for data for the whole country that can be provided with district level aggregates or similar. At a district or province office the users will typically have facility level data only for their own area, and then for the neighboring areas the data will be aggregated up one or two levels to reduce the size of data, but still allow for comparison, split into e.g. the two tables Facility Data and Data District Data, and similar for indicator values. Splitting data by period or by data element/indicator groups work more or less in the same way, and can be done either in combination with the organisation unit splitting or instead of it. E.g. if a health program wants to analyse a few data elements at facility level for the whole country that can be possible. The splitting is controlled by the pivot views in the database where one specifies which data values to fetch.</para>
  </section>
  <section>
    <title>The MyDatamart tool</title>
    <para>Com as implantações on-line eo uso de um único servidor central ( e banco de dados ), o uso local de tabelas dinâmicas torna-se mais difícil, pois o Excel se conecta ao banco de dados diretamente para buscar os dados . Isso significa que o Excel ( e cada computador local usando DHIS2 ) precisaria detalhes de conexão e acesso ao banco de dados no servidor, o que nem sempre é desejado. Além disso ,
a atualização ( atualizar a tabela dinâmica ) operação em Excel esvazia completamente a mesa antes de recarregar todos os dados novamente ( novos e antigos) , o que leva a grandes e duplicados downloads de dados através da Internet ao conectar a um servidor online. A solução para estes problemas tem sido a de construir e manter uma &quot; cópia &quot; atualizada do banco de dados central em cada escritório local onde eles usam tabelas dinâmicas do Excel. Estas bases de dados locais são chamados de data marts e são construídos especificamente para servir como fontes de dados para ferramentas de análise de dados, como o Excel. A ferramenta é um MyDatamart (maio de 2011) ferramenta recém-desenvolvida que cria um arquivo datamart em um computador local e ajuda os usuários a atualizar esta relação a um servidor central. As tabelas dinâmicas no Excel conectar apenas ao datamart local e não precisa saber sobre o servidor central em tudo.</para>
    <para>O uso de MyDatamart reduz drasticamente o tamanho do download quando rotineiramente atualizar os arquivos locais do Excel contra o servidor central em comparação com uma conexão direta do Excel. Ele também traz conforto para os usuários de nível local para ter uma cópia de seus dados em seu computador local e não depender de uma conexão de Internet ou servidor de up-tempo para acessá-lo. A figura abaixo explica como a ligação entre o servidor online central (nas nuvens), e os escritórios locais de obras.</para>
    <graphic fileref="resources/images/implementation_guide/mydatamart.png" format="PNG" width="100%" align="center"/>
  </section>
  <section>
    <title>O uso de tabelas dinâmicas do Excel e MyDatamart - um exemplo de fluxo de trabalho</title>
    <para>Os detalhes do uso da ferramenta MyDatamart são explicados em um manual de usuário separada e esta seção só tenta explicar o típico fluxo de trabalho envolvido no uso da ferramenta, juntamente com as tabelas dinâmicas..</para>
    <section>
      <title>Download and run the MyDatamart tool for the first time</title>
      <para>MyDatamart é uma pequena ferramenta que é fácil de baixar e executar imediatamente. Baixe mydatamart.exe na área de trabalho e execute-o clicando duas vezes no arquivo. A primeira coisa que você precisa fazer é criar um novo arquivo de datamart , e então você digitar os dados de login necessários para acessar o servidor central ( url, nome de usuário . Senha). A ferramenta irá se conectar ao servidor (conexão de Internet necessária neste momento) e verificar suas credenciais. O próximo passo é fazer o download de todos os meta- dados do servidor ou seja, todas as unidades da organização, elementos de dados , indicadores , grupos , etc Isso pode levar algum tempo, dependendo das especificações do seu computador e da velocidade da conexão, mas é uma passo que raramente é necessária após este primeiro download. Uma vez que a ferramenta conhece a hierarquia unidade de organização , você pode especificar qual a organização unidade que &quot; pertencem&quot; a eo nível de análise que você está interessado polegadas Essas são as configurações que limitam quais unidades organizacionais que você irá fazer o download de dados para . O próximo passo é fazer o download dos dados do servidor e, em seguida, você deve especificar quais os períodos de baixar.        
 </para>
    </section>
    <section>
      <title>Configuração e distribuir as tabelas dinâmicas</title>
      <para>A primeira coisa necessária é para baixar e instalar um driver ODBC para o SQLite, que é o servidor de banco de dados executando o datamart local. As conexões de banco de dados nas tabelas dinâmicas dependem deste motorista e falhará sem instalado.</para>
      <para>O próximo passo é configurar as tabelas pivô si. Este é um trabalho único, uma vez que o arquivo possa ser reutilizado como um modelo em todos os outros locais que se conectam ao mesmo banco de dados central. A ferramenta MyDatamart pode produzir um arquivo Excel esqueleto para você com todas as conexões de banco de dados necessários já definidos. Isso vai ajudar o processo consideravelmente e maior parte do trabalho é selecionar os campos a utilizar em cada mesa e dar-lhes nomes próprios.
O manual do utilizador tem todas as instruções detalhadas sobre como configurar uma tabela dinâmica usando as conexões MyDatamart.</para>
      <para>Uma vez que o arquivo de modelo do Excel está disponível, é uma questão de distribuir a todos os escritórios locais que irão usar tabelas dinâmicas e para certificar-se as conexões ainda são válidos nos computadores locais. Os detalhes de conexão no Excel dependem do driver ODBC estar disponível e sobre o nome ea localização do arquivo de datamart. Ou você pode agilizar todos os arquivos datamart locais (pelo nome e localização, e.g. &quot;C:\dhis2\dhis2.dmart&quot;, ou você pode usar a ferramenta MyDatamart para atualizar os detalhes de conexão em um arquivo do Excel existente para coincidir com a localização do arquivo de datamart local.</para>
    </section>
    <section>
      <title>Actualização do MyDatamart</title>
      <para>Sempre que há novos dados disponíveis no servidor central, por exemplo, cada mês, os usuários terão que abrir a ferramenta MyDatamart, fazer logon no servidor, e em seguida, escolher os meses para fazer o download. Uma vez que o download terminar os dados estão disponíveis localmente no arquivo datamart.</para>
    </section>
    <section>
      <title>Atualizar as tabelas dinâmicas</title>
      <para>Uma vez que o arquivo datamart local tem sido atualizar os usuários podem atualizar as tabelas dinâmicas usando a função Refresh, uma vez por tabela. É importante lembrar-se de salvar o arquivo de Excel depois de atualizar todas as tabelas.</para>
    </section>
    <section>
      <title>Repita os passos 3 e 4, quando novos dados estão disponíveis no servidor central</title>
      <para>Sempre que há novos dados sobre o número de repetição servidor passo 3 e 4 (as duas etapas anteriores), a fim de atualizar as tabelas dinâmicas e tenha acesso aos dados mais recentes.</para>
    </section>
  </section>
</chapter>
